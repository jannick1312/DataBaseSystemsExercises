%% ================================================================
%% # DBIS Databases Hand-in Template
%% 
%% Template for students to hand-in their databases exercise solutions.
%% 
%% [Databases and Information Systems Group](https://dbis.dmi.unibas.ch/)
%%
%% ## Usage
%% 
%% Fill in the required fields and write your submission
%%
%% ## Issues
%%
%% See dbisdbhandin.sty for further information.
%% ================================================================
\documentclass{article}
\usepackage{dbisdbhandin}
\usepackage[english]{babel}
%% ================================================================
%%
%% General Information
%%
%% ================================================================
%%
%% Add your information here
\course       {Databases}
\semester     {Autumn 2025}
\exerciseno   {1}
\studenta     {Aiysha Frutiger}
\studentb     {Jannick Seper}
\studentc     {Luis Tritschler}
%% Comment if you do the exercises alone


%% ================================================================
%%
%% Common Packages
%%
%% ================================================================
%%
%% Useful common packages for this course

%% Include pdfs into latex
\usepackage{pdfpages}
%% \includepdf[pages=1,pagecommand={\pagestyle{fancy}}]{filename}

%% Drawing everything, with lots of libraries
\usepackage{tikz}
%% A library providing ER prefabs
\usetikzlibrary{er}
\usetikzlibrary{positioning,arrows.meta}
%% ================================================================
%%
%% Custom Packages
%%
%% ================================================================
%%
%% Add custom packages below:
%%

% \usepackage{mypackage}

%% ================================================================
%%
%% Custom Commands
%%
%% ================================================================
%%
%% DRY: Use commands when you use something often or you'd like
%% to define it only once
%%

\newcommand*{\TikZ}{Ti\textit{k}Z}


\begin{document}
%% Required for the title
\printfront
%% ================================================================
%%
%% Description
%%
%% ================================================================

This template showcases various useful latex commands and setups.
Remove this for your actual hand-in.

%% ================================================================
%%
%% Your Solution
%%
%% ================================================================
%%
%% Add your solution below
\task{}
Relational algebra is a treat with \LaTeX, as can be seen in~\Cref{eq:ans}:

\begin{equation}
\label{eq:ans}
\pi\left[Attribute1,Attribute2\right](\sigma\left[Attribute=Something\right](Entity1) \Join Entity2)
\end{equation}

\task{}

\begin{enumerate}[(a)]
\item 
Person on Name:
\begin{equation}
\sigma\left[Name='Christopher Nolan'\right](Person)
\end{equation}

Activity on SceneAuthor:
\begin{equation}
\sigma\left[Activity='director'\right](SceneAuthor)
\end{equation}

Add join on both:
\begin{multline}
\pi\left[MovieID,SceneID\right](\sigma\left[Name='Christopher Nolan' \land Activity='director'\right]\\
 (Person \Join SceneAuthor))
\end{multline}

\item
Movie on Title:
\begin{equation}
\sigma[MovieTitle='Inception'](Movie)
\end{equation}

Hans Zimmer as composer (within that movie):
\begin{multline}
\pi\left[MovieID,SceneID\right]\\
 (\sigma\left[MovieTitle='Inception' \land Name='Hans Zimmer' \land Activity='composer'\right]\\
 (Movie \Join SceneAuthor \Join Person))
\end{multline}

Christopher Nolan as screenwriter (within that movie):
\begin{multline}
\pi\left[MovieID,SceneID\right]\\
 (\sigma\left[MovieTitle='Inception' \land Name='Christopher Nolan' \land Activity='screenwriter'\right]\\
 (Movie \Join SceneAuthor \Join Person))
\end{multline}

Intersect on scene key then output SceneID:
\begin{multline}
\pi\left[SceneID\right]\\
((\pi\left[MovieID,SceneID\right]\\
 (\sigma\left[MovieTitle='Inception' \land Name='Hans Zimmer' \land Activity='composer'\right]\\
 (Movie \Join SceneAuthor \Join Person))) \cap \\
 (\pi\left[MovieID,SceneID\right]\\
 (\sigma\left[MovieTitle='Inception' \land Name='Christopher Nolan' \land Activity='screenwriter'\right]\\
 (Movie \Join SceneAuthor \Join Person))))
\end{multline}

\item
Person on Name:
\begin{equation}
\sigma\left[Name='Quentin Tarantino'\right](Person)
\end{equation}

Actor role on ScenePerformer:
\begin{equation}
\sigma\left[Role='actor'\right](ScenePerformer)
\end{equation}

Director activity on SceneAuthor:
\begin{equation}
\sigma\left[Activity='director'\right](SceneAuthor)
\end{equation}

Combine and output scene Titles:
\begin{multline}
\pi\left[Title\right](\sigma\left[Name='Quentin Tarantino' \land Role='actor' \land Activity='director'\right]\\
 (Scene \Join ScenePerformer \Join SceneAuthor \Join Person))
\end{multline}

\item
Actor on ScenePerformer:
\begin{equation}
\sigma\left[Name='Robert Downey Jr.' \land Role='actor'\right](ScenePerformer \Join Person)
\end{equation}

Author on SceneAuthor:
\begin{equation}
\sigma\left[Name='Robert Downey Jr.'\right](SceneAuthor \Join Person)
\end{equation}

Union on MovieID, then output MovieTitle:
\begin{multline}
\pi\left[MovieTitle\right]\\
 ((\pi\left[MovieID\right](\sigma\left[Name='Robert Downey Jr.' \land Role='actor'\right](ScenePerformer \Join Person))\\
 \cup \pi\left[MovieID\right](\sigma\left[Name='Robert Downey Jr.'\right](SceneAuthor \Join Person))) \Join Movie)
\end{multline}

\item
Actor on ScenePerformer:
\begin{equation}
\sigma\left[Name='Scarlett Johansson' \land Role='actor'\right](ScenePerformer \Join Person)
\end{equation}

Stunt double on ScenePerformer:
\begin{equation}
\sigma\left[Name='Scarlett Johansson' \land Role='stunt double'\right](ScenePerformer \Join Person)
\end{equation}

Intersect on scene key, then output Titles:
\begin{multline}
\pi\left[Title\right]\\
 ((\pi\left[MovieID,SceneID\right](\sigma\left[Name='Scarlett Johansson' \land Role='actor'\right]\\
 (ScenePerformer \Join Person)) \cap \pi\left[MovieID,SceneID\right]\\
 (\sigma\left[Name='Scarlett Johansson' \land Role='stunt double'\right](ScenePerformer \Join Person))) \Join Scene
)
\end{multline}

\item
Person on Name (subset of Person):
\begin{equation}
F_{1.1} = \{p | p \in Person \land p.Name='Christopher Nolan' \}
\end{equation}

Activity on SceneAuthor (subset of SceneAuthor):
\begin{equation}
F_{1.2} = \{sa | sa \in SceneAuthor \land sa.Activity='director' \}
\end{equation}

Join by PID, output (MovieID,SceneID) without Person:
\begin{multline}
\{\langle sa.MovieID, sa.SceneID \rangle | sa \in F_{1.1} \land \exists p\,(p \in F_{1.2} \land p.PID = sa.PID)\}
\end{multline}


\end{enumerate}

\end{document}
